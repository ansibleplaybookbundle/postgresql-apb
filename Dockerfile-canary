FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAuMApuYW1lOiBwb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NM\
IFBvc3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRp\
b25hbAp0YWdzOgogIC0gZGF0YWJhc2UKICAtIHBvc3RncmVzcWwKbWV0YWRhdGE6CiAgZG9jdW1l\
bnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5vcmcvZG9jcy8KICBsb25nRGVzY3Jp\
cHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNxbCA5LjUsIDkuNiBvciAxMC4KICBk\
ZXBlbmRlbmNpZXM6CiAgICAtICdkb2NrZXIuaW8vY2VudG9zL3Bvc3RncmVzcWwtOTUtY2VudG9z\
NycKICAgIC0gJ2RvY2tlci5pby9jZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3JwogICAgLSAn\
ZG9ja2VyLmlvL2NlbnRvcy9wb3N0Z3Jlc3FsLTEwLWNlbnRvczcnCiAgZGlzcGxheU5hbWU6IFBv\
c3RncmVTUUwgKEFQQikKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGljb24tcG9z\
dGdyZXNxbAogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAt\
IG5hbWU6IGRldgogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERCIHNlcnZlciB3aXRoIG5vIHN0\
b3JhZ2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGV2\
ZWxvcG1lbnQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiBwcm92aWRl\
cyBhIHNpbmdsZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aG91dAogICAgICAgIHBlcnNp\
c3RlbnQgc3RvcmFnZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgLSBu\
YW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAgICAg\
ICAgcGF0dGVybjogIl5bYS16QS1aX11bYS16QS1aMC05X10qJCIKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFkbWlu\
CiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIG1heGxlbmd0aDogNjMKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlf\
XSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNz\
d29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBhc3N3\
b3JkCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHBhdHRlcm46ICJeW2Et\
ekEtWjAtOV9+IUAjJCVeJiooKS09PD4sLj87OnxdKyQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK\
ICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnMTAnCiAg\
ICAgICAgZW51bTogWycxMCcsICc5LjYnLCAnOS41J10KICAgICAgICB0eXBlOiBlbnVtCiAgICAg\
ICAgdGl0bGU6IFBvc3RncmVTUUwgVmVyc2lvbgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
ICAgdXBkYXRhYmxlOiB0cnVlCiAgICB1cGRhdGVzX3RvOgogICAgICAtIHByb2QKICAtIG5hbWU6\
IHByb2QKICAgIGRlc2NyaXB0aW9uOiBBIHNpbmdsZSBEQiBzZXJ2ZXIgd2l0aCBwZXJzaXN0ZW50\
IHN0b3JhZ2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTog\
UHJvZHVjdGlvbgogICAgICBsb25nRGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHByb3Zp\
ZGVzIGEgc2luZ2xlIG5vbi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRoCiAgICAgICAgcGVyc2lz\
dGVudCBzdG9yYWdlCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5h\
bWU6IHBvc3RncmVzcWxfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAgICAg\
ICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0\
cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF91c2VyCiAgICAgICAgZGVmYXVsdDogYWRtaW4K\
ICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgbWF4bGVuZ3RoOiA2MwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWl9dW2EtekEtWjAtOV9d\
KiQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3Bhc3N3\
b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dv\
cmQKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcGF0dGVybjogIl5bYS16\
QS1aMC05X34hQCMkJV4mKigpLT08PiwuPzs6fF0rJCIKICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICcxMCcKICAg\
ICAgICBlbnVtOiBbJzEwJywgJzkuNicsICc5LjUnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAg\
ICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICB1cGRhdGFibGU6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZvbHVtZV9zaXplCiAg\
ICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTogWycx\
R2knLCAnNUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFZvbHVtZSBTaXpl\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0gZGV2Cg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/postgresql-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
