FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAuMApuYW1lOiBwb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NM\
IFBvc3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRp\
b25hbAp0YWdzOgogIC0gZGF0YWJhc2UKICAtIHBvc3RncmVzcWwKbWV0YWRhdGE6CiAgZG9jdW1l\
bnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5vcmcvZG9jcy8KICBsb25nRGVzY3Jp\
cHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNxbCA5LjQsIDkuNSwgb3IgOS42Lgog\
IGRlcGVuZGVuY2llczoKICAgIC0gJ2RvY2tlci5pby9jZW50b3MvcG9zdGdyZXNxbC05NC1jZW50\
b3M3JwogICAgLSAnZG9ja2VyLmlvL2NlbnRvcy9wb3N0Z3Jlc3FsLTk1LWNlbnRvczcnCiAgICAt\
ICdkb2NrZXIuaW8vY2VudG9zL3Bvc3RncmVzcWwtOTYtY2VudG9zNycKICBkaXNwbGF5TmFtZTog\
UG9zdGdyZVNRTCAoQVBCKQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1w\
b3N0Z3Jlc3FsCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgog\
IC0gbmFtZTogZGV2CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2VydmVyIHdpdGggbm8g\
c3RvcmFnZQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBE\
ZXZlbG9wbWVudAogICAgICBsb25nRGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHByb3Zp\
ZGVzIGEgc2luZ2xlIG5vbi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRob3V0CiAgICAgICAgcGVy\
c2lzdGVudCBzdG9yYWdlCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAt\
IG5hbWU6IHBvc3RncmVzcWxfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAg\
ICAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVk\
OiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF91c2VyCiAgICAgICAgZGVmYXVsdDogYWRt\
aW4KICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgbWF4bGVuZ3RoOiA2MwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWl9dW2EtekEtWjAt\
OV9dKiQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3Bh\
c3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFz\
c3dvcmQKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcGF0dGVybjogIl5b\
YS16QS1aMC05X34hQCMkJV4mKigpLT08PiwuPzs6fF0rJCIKICAgICAgICByZXF1aXJlZDogdHJ1\
ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICc5LjYn\
CiAgICAgICAgZW51bTogWyc5LjYnLCAnOS41JywgJzkuNCddCiAgICAgICAgdHlwZTogZW51bQog\
ICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFZlcnNpb24KICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAgIHVwZGF0YWJsZTogdHJ1ZQogICAgdXBkYXRlc190bzoKICAgICAgLSBwcm9kCiAgLSBu\
YW1lOiBwcm9kCiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2VydmVyIHdpdGggcGVyc2lz\
dGVudCBzdG9yYWdlCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5h\
bWU6IFByb2R1Y3Rpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiBw\
cm92aWRlcyBhIHNpbmdsZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aAogICAgICAgIHBl\
cnNpc3RlbnQgc3RvcmFnZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAg\
LSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAg\
ICAgICAgcGF0dGVybjogIl5bYS16QS1aX11bYS16QS1aMC05X10qJCIKICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFk\
bWluCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIG1heGxlbmd0aDogNjMKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVow\
LTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF9w\
YXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBh\
c3N3b3JkCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHBhdHRlcm46ICJe\
W2EtekEtWjAtOV9+IUAjJCVeJiooKS09PD4sLj87OnxdKyQiCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnOS42\
JwogICAgICAgIGVudW06IFsnOS42JywgJzkuNScsICc5LjQnXQogICAgICAgIHR5cGU6IGVudW0K\
ICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK\
ICAgICAgICB1cGRhdGFibGU6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZvbHVtZV9z\
aXplCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51\
bTogWycxR2knLCAnNUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFZvbHVt\
ZSBTaXplCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0gZGV2\
Cg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/postgresql-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
