FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAuMApuYW1lOiBwb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NM\
IFBvc3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRp\
b25hbAp0YWdzOgogIC0gZGF0YWJhc2UKICAtIHBvc3RncmVzcWwKbWV0YWRhdGE6CiAgZG9jdW1l\
bnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5vcmcvZG9jcy8KICBsb25nRGVzY3Jp\
cHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNxbCA5LjQsIDkuNSwgb3IgOS42Lgog\
IGRlcGVuZGVuY2llczoKICAgIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5yZWRoYXQuY29tL3Joc2NsL3Bv\
c3RncmVzcWwtOTQtcmhlbDcnCiAgICAtICdyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNvbS9yaHNj\
bC9wb3N0Z3Jlc3FsLTk1LXJoZWw3JwogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20v\
cmhzY2wvcG9zdGdyZXNxbC05Ni1yaGVsNycKICBkaXNwbGF5TmFtZTogUG9zdGdyZVNRTCAoQVBC\
KQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1wb3N0Z3Jlc3FsCiAgcHJv\
dmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFtZTogZGV2CiAg\
ICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2VydmVyIHdpdGggbm8gc3RvcmFnZQogICAgZnJl\
ZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZXZlbG9wbWVudAogICAg\
ICBsb25nRGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHByb3ZpZGVzIGEgc2luZ2xlIG5v\
bi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRob3V0CiAgICAgICAgcGVyc2lzdGVudCBzdG9yYWdl\
CiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IHBvc3RncmVz\
cWxfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAgICAgICBwYXR0ZXJuOiAi\
XlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0g\
bmFtZTogcG9zdGdyZXNxbF91c2VyCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0aXRs\
ZTogUG9zdGdyZVNRTCBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgbWF4bGVuZ3Ro\
OiA2MwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWl9dW2EtekEtWjAtOV9dKiQiCiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3Bhc3N3b3JkCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dvcmQKICAgICAgICBk\
aXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X34hQCMk\
JV4mKigpLT08PiwuPzs6fF0rJCIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6\
IHBvc3RncmVzcWxfdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICc5LjYnCiAgICAgICAgZW51bTog\
Wyc5LjYnLCAnOS41JywgJzkuNCddCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIHRpdGxlOiBQ\
b3N0Z3JlU1FMIFZlcnNpb24KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHVwZGF0YWJs\
ZTogdHJ1ZQogICAgdXBkYXRlc190bzoKICAgICAgLSBwcm9kCiAgLSBuYW1lOiBwcm9kCiAgICBk\
ZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2VydmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdlCiAg\
ICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IFByb2R1Y3Rpb24K\
ICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiBwcm92aWRlcyBhIHNpbmds\
ZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aAogICAgICAgIHBlcnNpc3RlbnQgc3RvcmFn\
ZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBwb3N0Z3Jl\
c3FsX2RhdGFiYXNlCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAgICAgICAgcGF0dGVybjog\
Il5bYS16QS1aX11bYS16QS1aMC05X10qJCIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAt\
IG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdGl0\
bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIG1heGxlbmd0\
aDogNjMKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNzd29yZAogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBhc3N3b3JkCiAgICAgICAg\
ZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9+IUAj\
JCVeJiooKS09PD4sLj87OnxdKyQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1l\
OiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnOS42JwogICAgICAgIGVudW06\
IFsnOS42JywgJzkuNScsICc5LjQnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRsZTog\
UG9zdGdyZVNRTCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICB1cGRhdGFi\
bGU6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZvbHVtZV9zaXplCiAgICAgICAgdHlw\
ZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTogWycxR2knLCAnNUdp\
JywgJzEwR2knXQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFZvbHVtZSBTaXplCiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0gZGV2Cg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/postgresql-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
