FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBTaGFyZWQgUGFyYW1ldGVycwojIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIwpfcDogJl9wCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICBkZWZh\
dWx0OiBhZG1pbgogICAgdHlwZTogc3RyaW5nCiAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFz\
ZSBOYW1lCiAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgcmVxdWly\
ZWQ6IHRydWUKICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgZGVmYXVsdDogYWRtaW4KICAg\
IHRpdGxlOiBQb3N0Z3JlU1FMIFVzZXIKICAgIHR5cGU6IHN0cmluZwogICAgbWF4bGVuZ3RoOiA2\
MwogICAgcGF0dGVybjogIl5bYS16QS1aX11bYS16QS1aMC05X10qJCIKICAgIHJlcXVpcmVkOiB0\
cnVlCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3Bhc3N3b3JkCiAgICB0eXBlOiBzdHJpbmcKICAgIHRp\
dGxlOiBQb3N0Z3JlU1FMIFBhc3N3b3JkCiAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICBw\
YXR0ZXJuOiAiXlthLXpBLVowLTlffiFAIyQlXiYqKCktPTw+LC4/Ozp8XSskIgogICAgcmVxdWly\
ZWQ6IHRydWUKICAtIG5hbWU6IHBvc3RncmVzcWxfdmVyc2lvbgogICAgZGVmYXVsdDogJzkuNicK\
ICAgIGVudW06IFsnOS42JywgJzkuNScsICc5LjQnXQogICAgdHlwZTogZW51bQogICAgdGl0bGU6\
IFBvc3RncmVTUUwgVmVyc2lvbgogICAgcmVxdWlyZWQ6IHRydWUKICAgIHVwZGF0YWJsZTogdHJ1\
ZQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp2ZXJzaW9uOiAxLjAKbmFtZTogcG9zdGdyZXNxbC1h\
cGIKZGVzY3JpcHRpb246IFNDTCBQb3N0Z3JlU1FMIGFwYiBpbXBsZW1lbnRhdGlvbgpiaW5kYWJs\
ZTogdHJ1ZQphc3luYzogb3B0aW9uYWwKdGFnczoKICAtIGRhdGFiYXNlCiAgLSBwb3N0Z3Jlc3Fs\
Cm1ldGFkYXRhOgogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3RncmVzcWwub3Jn\
L2RvY3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBvc3RncmVzcWwg\
OS40LCA5LjUsIG9yIDkuNi4KICBkZXBlbmRlbmNpZXM6CiAgICAtICdyZWdpc3RyeS5hY2Nlc3Mu\
cmVkaGF0LmNvbS9yaHNjbC9wb3N0Z3Jlc3FsLTk0LXJoZWw3JwogICAgLSAncmVnaXN0cnkuYWNj\
ZXNzLnJlZGhhdC5jb20vcmhzY2wvcG9zdGdyZXNxbC05NS1yaGVsNycKICAgIC0gJ3JlZ2lzdHJ5\
LmFjY2Vzcy5yZWRoYXQuY29tL3Joc2NsL3Bvc3RncmVzcWwtOTYtcmhlbDcnCiAgZGlzcGxheU5h\
bWU6IFBvc3RncmVTUUwgKEFQQikKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGlj\
b24tcG9zdGdyZXNxbAogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFu\
czoKICAtIG5hbWU6IGRldgogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERCIHNlcnZlciB3aXRo\
IG5vIHN0b3JhZ2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFt\
ZTogRGV2ZWxvcG1lbnQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMg\
YSBzaW5nbGUgbm9uLUhBIFBvc3RncmVTUUwgc2VydmVyIHdpdGhvdXQgcGVyc2lzdGVudCBzdG9y\
YWdlCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOiAqX3AKICAgIHVwZGF0ZXNfdG86\
CiAgICAgIC0gcHJvZAogIC0gbmFtZTogcHJvZAogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERC\
IHNlcnZlciB3aXRoIHBlcnNpc3RlbnQgc3RvcmFnZQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIGRpc3BsYXlOYW1lOiBQcm9kdWN0aW9uCiAgICAgIGxvbmdEZXNjcmlwdGlvbjog\
VGhpcyBwbGFuIHByb3ZpZGVzIGEgc2luZ2xlIG5vbi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRo\
IHBlcnNpc3RlbnQgc3RvcmFnZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogKl9w\
CiAgICB1cGRhdGVzX3RvOgogICAgICAtIGRldgo="


COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
